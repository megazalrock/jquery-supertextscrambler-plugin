/*! jQuery Super Text Scrambler 2014-05-01
 *  Vertion : 1.0.1
 *  Dependencies : jQuery *
 *  Author : MegazalRock (Otto Kamiya)
 *  Copyright (c) 2014 MegazalRock (Otto Kamiya);
 *  License : */
(function(e,t){function r(e,t){for(var r=0;t>r;r+=1)e.currentText=e.text.slice(0,e.currentTextLength+1),e.currentTextLength=e.currentText.length;return e.currentText}function a(e,r,a){var n=[];if("typewriter"===a)n=r%2?["_"]:[" ","|"," "],2>r&&(n=n.splice(0,n.length-(2-r)));else{var i,o,s,h=0,c=t.isArray(e.charTable[a]);for(c||(i=e.charTable[a].startCharCode,o=e.charTable[a].endCharCode);r>h;h++)c&&(s=parseInt(Math.random()*e.charTable[a].length,10),i=e.charTable[a][s].startCharCode,o=e.charTable[a][s].endCharCode),-1!==t.inArray(h,e.spaceIndexList)&&e.options.saveSpace?n.push(" "):n.push(String.fromCharCode(i+parseInt(Math.random()*(o-i),10)))}return n.join("")}function n(e){e.options.autoWordBreak&&e.$target.css(e.defaultCss),e.deferred.resolve(),e.$target.trigger("scramblerEnd")}function i(e,t){for(var r=[],a=e.indexOf(t);-1!==a;a=e.indexOf(t,a+1))r.push(a);return r}e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){return e.setTimeout(function(){t(Date.now())},1e3/60)},e.cancelAnimationFrame=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.mozCancelAnimationFrame||e.oCancelAnimationFrame||e.msCancelAnimationFrame||function(e){return clearTimeout(e)};var o={mode:"auto",wait:1e3,fps:30,textFps:30,autoWordBreak:!0,saveSpace:!0,returnPrimise:!1,addQueue:!0},s=function(e,r,a){var n;a=a||{},this.options=t.extend(!0,{},t.extend(!0,o,a)),this.text=r,this.length=r.length,this.currentTextLength=0,this.currentText="",this.spaceIndexList=i(this.text," "),this.charTable={kanji:{startCharCode:20124,endCharCode:29081,length:8957},hiragana:{startCharCode:12353,endCharCode:12435,length:82},katakana:{startCharCode:12449,endCharCode:12534,length:85},ja:[],keisen:{startCharCode:9472,endCharCode:9538,length:66},en:{startCharCode:65,endCharCode:122,length:57}},this.charTable.ja=[this.charTable.kanji,this.charTable.hiragana,this.charTable.katakana],this.charTableJaLength=0;for(n in this.charTable.ja)this.charTableJaLength+=this.charTable.ja[n].length;this.$target=e};s.prototype.init=function(){var e=this,t=e.$target;e.currentTextLength=0,e.currentText="","auto"===e.options.mode&&(e.options.mode=/[ぁ-ん]/.test(e.text)||/[ァ-ン]/.test(e.text)?"ja":"en"),e.options.autoWordBreak&&(e.defaultCss={wordWrap:t.css("word-wrap"),wordBreak:t.css("word-break")},t.css({wordWrap:"break-word",wordBreak:"break-all"})),t.trigger("scramblerStart")},s.prototype.start=function(){var i,o,s,h=this,c=h.$target,u=h.length,d=h.options.mode,m=Date.now(),l=1e3/h.options.fps,p=m,f=1e3/h.options.textFps,x=Math.floor(h.options.textFps/30)+(h.options.textFps%30?1:0);return h.currentTextLength=0,h.currentText="",h.deferred=t.Deferred(),setTimeout(function(){(function t(){o=Date.now(),h.rafId=e.requestAnimationFrame(t),i=o-m,s=o-p,u>h.currentTextLength?i>=l&&(s>=f?c.text(r(h,x)+a(h,u-h.currentTextLength,d)):c.text(h.currentText+a(h,u-h.currentTextLength,d)),m=o-i%l,p=o-s%f):(e.cancelAnimationFrame(h.rafId),n(h))})()},h.options.wait),h.deferred.promise()},t.extend({SuperTextScrambler:function(e,t,r){return new s(e,t,r)}}),t.fn.extend({superTextScrambler:function(e){e=t.extend(!0,o,e);var r,a=t(this),n=a.length,i=0,h=[];return e.returnPrimise&&(r=t.Deferred()),a.each(function(e){h[e]=t(this).text(),t(this).empty()}),function c(){var t=a.eq(i),r=h[i];0!==i&&(e.wait=0);var o=t.data("SuperTextScrambler")||new s(t,r,e);o.init(),o.start().done(function(){n>i+1&&(i+=1,c())})}(),e.returnPrimise?r.promise():this}})})(this,jQuery);