/*! jQuery Super Text Scrambler 2014-03-14
 *  Vertion : 0.1.0
 *  Dependencies : jQuery *
 *  Author : MegazalRock (Otto Kamiya)
 *  Copyright (c) 2014 MegazalRock (Otto Kamiya);
 *  License : */
(function(t,e){t.requestAnimationFrame=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return t.setTimeout(function(){e(Date.now())},1e3/60)},t.cancelAnimationFrame=t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.mozCancelAnimationFrame||t.oCancelAnimationFrame||t.msCancelAnimationFrame||function(t){return clearTimeout(t)};var n=function(t,n){n=n||{},this.options=e.extend(!0,{mode:"en",wait:1e3,fps:30,textFps:30,autoWordBreak:!0,saveSpace:!0},n),this.text=t,this.length=t.length,this.currentTextLength=0,this.currentText="",this.spaceIndexList=this.allIndexOf(this.text," ")};n.prototype.init=function(t){var e=this;e.$target=t,e.currentTextLength=0,e.currentText="",e.options.autoWordBreak&&(e.defaultCss={wordWrap:t.css("word-wrap"),wordBreak:t.css("word-break")},t.css({wordWrap:"break-word",wordBreak:"break-all"})),t.trigger("scramblerStart")},n.prototype.start=function(){var e,n,r,a=this,o=a.$target,i=a.length,s=a.options.mode,u=Date.now(),c=1e3/a.options.fps,m=u,p=1e3/a.options.textFps,x=Math.floor(a.options.textFps/30)+(a.options.textFps%30?1:0);setTimeout(function(){(function h(){n=Date.now(),a.rafId=t.requestAnimationFrame(h),e=n-u,r=n-m,i>a.currentTextLength?e>=c&&(r>=p?o.text(a.stepText(x)+a.getRndText(i-a.currentTextLength,s)):o.text(a.currentText+a.getRndText(i-a.currentTextLength,s)),u=n-e%c,m=n-r%p):(t.cancelAnimationFrame(a.rafId),a.end())})()},a.options.wait)},n.prototype.stepText=function(t){for(var e=this,n=0;t>n;n+=1)e.currentText=e.text.slice(0,e.currentTextLength+1),e.currentTextLength=e.currentText.length;return e.currentText},n.prototype.getRndText=function(t,n){var r,a,o=this,i=[],s=0;for(n=n||"en","en"===n?(r=65,a=122):(r=19968,a=40864);t>s;s++)-1!==e.inArray(s,o.spaceIndexList)&&o.options.saveSpace?i.push(" "):i.push(String.fromCharCode(r+Math.floor(Math.random()*(a-r))));return i.join("")},n.prototype.end=function(){var t=this;t.options.autoWordBreak&&t.$target.css(t.defaultCss),t.$target.trigger("scramblerEnd")},n.prototype.allIndexOf=function(t,e){for(var n=[],r=t.indexOf(e);-1!==r;r=t.indexOf(e,r+1))n.push(r);return n},e.extend({SuperTextScrambler:function(t,e){return new n(t,e)}}),e.fn.extend({superTextScrambler:function(t){return e(this).each(function(){var r=e(this),a=r.text();if((a+"").length){var o=r.data("SuperTextScrambler")||new n(a,t);o.init(r),o.start(),r.data("SuperTextScrambler",o)}}),this}})})(this,jQuery);